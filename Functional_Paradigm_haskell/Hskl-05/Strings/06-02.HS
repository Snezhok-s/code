   -- Демонстрация решения некоторых нетрудных задач,
   -- относящихся к обработке строк
   -------------------------------------------------
   -- Подключение модуля Char для функции digitToInt
   -------------------------------------------------
   import Char
   -- ************************************************
   -- Функция для вычеркивания из слова X всех букв 
   -- "с", "С", "л" и "Л" русского алфавита
   ----------------------------------------
   v x = (filter (/='л') (filter (/='с') 
                            (filter (/='С') (filter (/='Л') x))))
   --------------------------------------------------------------
   -- Модель встроенной функции filter по удалению всех вхождений
   -- указанного символа ATM из строки STR
   ---------------------------------------
   remove atm str | null str      = str
                  | atm==head str = remove atm (tail str)
                  | otherwise     = head str : remove atm (tail str)
   -- **************************************************************
   -- Функция, проверяющая, есть ли в слове X буква "К",
   -- стоящая на чётных местах перед буквой "И"
   --------------------------------------------
   present x | length x<3 = False
             | head (tail x)=='К' && head (tail (tail x))=='И'
                          = True
             | otherwise  = present (tail (tail x))
   -- ********************************************************
   -- Функция, позволяющая вычеркнуть из слова X все буквы "О"
   -- и букву, непосредственно следующую за буквой "О"
   ------------------------------------------------------
   delO x | (null x) || 
            (((head x) == 'О') && (null (tail x))) = ""
          | (((head x) == 'О') && ((head (tail x)) == 'О')) = 
                                                    (delO (tail x))
          | ((head x) == 'О') = (delO (tail (tail x)))
          | otherwise = (head x):(delO (tail x))
   ---------------------------------------------------
   -- Функция, преобразующая строку цифр в целое число
   ---------------------------------------------------
   str2num:: String -> Int
   str2num str | str == "" = error "Ошибка!"
               | (head str) == '-' = 
                 0-sum (str2num1 (reverse (tail str)) 
                                 ((length str)-1) 1)
               | otherwise = sum (str2num1 (reverse str)
                                           (length str) 1)
   -------------------------------------------------------
   str2num1:: String -> Int -> Int -> [Int]
   str2num1 str n m | (n==1) = [(digitToInt (head str))*m]
                    | otherwise = (digitToInt (head str))*m : 
                                        (str2num1 (tail str) 
                                                  (n-1) (m*10))
   ------------------------------------------------------------
   -- Неудачные тестовые примеры
   --------------------------------------------
   test = testV && testRemove && testPresent &&
          testDelO && testStr2num
   --------------------------------
   testV =   ((v "Слово") == "ово")
          && ((v "СПАС") == "ПА")
          && ((v "СллЛЛллс") == "")
          && ((v "") == "")
   ----------------------------------   
   testRemove =   remove 's' "" == ""
               && remove 'С' (remove 'л' "Слово") == "ово"
               && remove 'л' (remove 'с' (remove 'С'
                                  (remove 'Л' "СллЛЛллс"))) == ""
   --------------------------------------------------------------
   testPresent =   present "ЛЕСНИКИ"        == True
                && present "РИКИ-ТИКИ-ТАВИ" == True
                && present "Рики-Тики-Тави" == False
                && present "ПИКНИК"         == False          
   -------------------------------------------------
   testDelO =   delO "Ой!"        == "!"
             && delO "ОЛОВО"      == ""
             && delO "КОЛОС"      == "К"
             && delO "Корова"     == "Корова"
             && delO "ООиО"       == ""
             && delO "КООПЕРАТИВ" == "КЕРАТИВ"
   -------------------------------------------
   testStr2num =   str2num "1"           == 1
                && str2num "-1"          == -1
                && str2num "12"          == 12
                && str2num "-12"         == -12
                && str2num "123456789"   == 123456789
                && str2num "-123456789"  == -123456789
                && str2num "2147483647"  == 2147483647
                && str2num "-2147483647" == -2147483647
